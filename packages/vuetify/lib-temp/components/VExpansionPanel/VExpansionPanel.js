import '../../stylus/components/_expansion-panel.styl';
import Themeable from '../../mixins/themeable';
import { provide as RegistrableProvide } from '../../mixins/registrable';
import mixins from '../../util/mixins';
/* @vue/component */
export default mixins(Themeable, RegistrableProvide('expansionPanel')).extend({
    name: 'v-expansion-panel',
    provide() {
        return {
            expansionPanel: this
        };
    },
    props: {
        disabled: Boolean,
        readonly: Boolean,
        expand: Boolean,
        focusable: Boolean,
        inset: Boolean,
        popout: Boolean,
        value: {
            type: [Number, Array],
            default: () => null
        }
    },
    data: () => ({
        items: [],
        open: []
    }),
    computed: {
        classes() {
            return {
                'v-expansion-panel--focusable': this.focusable,
                'v-expansion-panel--popout': this.popout,
                'v-expansion-panel--inset': this.inset,
                ...this.themeClasses
            };
        }
    },
    watch: {
        expand(v) {
            let openIndex = -1;
            if (!v) {
                // Close all panels unless only one is open
                const openCount = this.open.reduce((acc, val) => val ? acc + 1 : acc, 0);
                const open = Array(this.items.length).fill(false);
                if (openCount === 1) {
                    openIndex = this.open.indexOf(true);
                }
                if (openIndex > -1) {
                    open[openIndex] = true;
                }
                this.open = open;
            }
            this.$emit('input', v ? this.open : (openIndex > -1 ? openIndex : null));
        },
        value(v) {
            this.updateFromValue(v);
        }
    },
    mounted() {
        this.value !== null && this.updateFromValue(this.value);
    },
    methods: {
        updateFromValue(v) {
            if (Array.isArray(v) && !this.expand)
                return;
            let open = Array(this.items.length).fill(false);
            if (typeof v === 'number') {
                open[v] = true;
            }
            else if (v !== null) {
                open = v;
            }
            this.updatePanels(open);
        },
        updatePanels(open) {
            this.open = open;
            for (let i = 0; i < this.items.length; i++) {
                const active = open && open[i];
                this.items[i].toggle(active);
            }
        },
        panelClick(uid) {
            const open = this.expand ? this.open.slice() : Array(this.items.length).fill(false);
            for (let i = 0; i < this.items.length; i++) {
                if (this.items[i]._uid === uid) {
                    open[i] = !this.open[i];
                    !this.expand && this.$emit('input', open[i] ? i : null);
                }
            }
            this.updatePanels(open);
            if (this.expand)
                this.$emit('input', open);
        },
        register(content) {
            this.items.push(content);
            this.open.push(false);
        },
        unregister(content) {
            const index = this.items.findIndex(i => i._uid === content._uid);
            this.items.splice(index, 1);
            this.open.splice(index, 1);
        }
    },
    render(h) {
        return h('ul', {
            staticClass: 'v-expansion-panel',
            class: this.classes
        }, this.$slots.default);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVkV4cGFuc2lvblBhbmVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVkV4cGFuc2lvblBhbmVsL1ZFeHBhbnNpb25QYW5lbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLCtDQUErQyxDQUFBO0FBSXRELE9BQU8sU0FBUyxNQUFNLHdCQUF3QixDQUFBO0FBQzlDLE9BQU8sRUFBRSxPQUFPLElBQUksa0JBQWtCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQTtBQUV4RSxPQUFPLE1BQU0sTUFBTSxtQkFBbUIsQ0FBQTtBQU10QyxvQkFBb0I7QUFDcEIsZUFBZSxNQUFNLENBQUMsU0FBUyxFQUFFLGtCQUFrQixDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDNUUsSUFBSSxFQUFFLG1CQUFtQjtJQUV6QixPQUFPO1FBQ0wsT0FBTztZQUNMLGNBQWMsRUFBRSxJQUFJO1NBQ3JCLENBQUE7SUFDSCxDQUFDO0lBRUQsS0FBSyxFQUFFO1FBQ0wsUUFBUSxFQUFFLE9BQU87UUFDakIsUUFBUSxFQUFFLE9BQU87UUFDakIsTUFBTSxFQUFFLE9BQU87UUFDZixTQUFTLEVBQUUsT0FBTztRQUNsQixLQUFLLEVBQUUsT0FBTztRQUNkLE1BQU0sRUFBRSxPQUFPO1FBQ2YsS0FBSyxFQUFFO1lBQ0wsSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQztZQUNyQixPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSTtTQUN1QjtLQUM3QztJQUVELElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ1gsS0FBSyxFQUFFLEVBQXNDO1FBQzdDLElBQUksRUFBRSxFQUFlO0tBQ3RCLENBQUM7SUFFRixRQUFRLEVBQUU7UUFDUixPQUFPO1lBQ0wsT0FBTztnQkFDTCw4QkFBOEIsRUFBRSxJQUFJLENBQUMsU0FBUztnQkFDOUMsMkJBQTJCLEVBQUUsSUFBSSxDQUFDLE1BQU07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SyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDM0IsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBQzVCLENBQUM7S0FDRjtJQUVELE1BQU0sQ0FBRSxDQUFDO1FBQ1AsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFO1lBQ2IsV0FBVyxFQUFFLG1CQUFtQjtZQUNoQyxLQUFLLEVBQUUsSUFBSSxDQUFDLE9BQU87U0FDcEIsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3pCLENBQUM7Q0FDRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJy4uLy4uL3N0eWx1cy9jb21wb25lbnRzL19leHBhbnNpb24tcGFuZWwuc3R5bCdcblxuaW1wb3J0IHsgVkV4cGFuc2lvblBhbmVsQ29udGVudCB9IGZyb20gJy4nXG5cbmltcG9ydCBUaGVtZWFibGUgZnJvbSAnLi4vLi4vbWl4aW5zL3RoZW1lYWJsZSdcbmltcG9ydCB7IHByb3ZpZGUgYXMgUmVnaXN0cmFibGVQcm92aWRlIH0gZnJvbSAnLi4vLi4vbWl4aW5zL3JlZ2lzdHJhYmxlJ1xuXG5pbXBvcnQgbWl4aW5zIGZyb20gJy4uLy4uL3V0aWwvbWl4aW5zJ1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICd2dWUnXG5pbXBvcnQgeyBQcm9wVmFsaWRhdG9yIH0gZnJvbSAndnVlL3R5cGVzL29wdGlvbnMnXG5cbnR5cGUgVkV4cGFuc2lvblBhbmVsQ29udGVudEluc3RhbmNlID0gSW5zdGFuY2VUeXBlPHR5cGVvZiBWRXhwYW5zaW9uUGFuZWxDb250ZW50PlxuXG4vKiBAdnVlL2NvbXBvbmVudCAqL1xuZXhwb3J0IGRlZmF1bHQgbWl4aW5zKFRoZW1lYWJsZSwgUmVnaXN0cmFibGVQcm92aWRlKCdleHBhbnNpb25QYW5lbCcpKS5leHRlbmQoe1xuICBuYW1lOiAndi1leHBhbnNpb24tcGFuZWwnLFxuXG4gIHByb3ZpZGUgKCk6IG9iamVjdCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGV4cGFuc2lvblBhbmVsOiB0aGlzXG4gICAgfVxuICB9LFxuXG4gIHByb3BzOiB7XG4gICAgZGlzYWJsZWQ6IEJvb2xlYW4sXG4gICAgcmVhZG9ubHk6IEJvb2xlYW4sXG4gICAgZXhwYW5kOiBCb29sZWFuLFxuICAgIGZvY3VzYWJsZTogQm9vbGVhbixcbiAgICBpbnNldDogQm9vbGVhbixcbiAgICBwb3BvdXQ6IEJvb2xlYW4sXG4gICAgdmFsdWU6IHtcbiAgICAgIHR5cGU6IFtOdW1iZXIsIEFycmF5XSxcbiAgICAgIGRlZmF1bHQ6ICgpID0+IG51bGxcbiAgICB9IGFzIGFueSBhcyBQcm9wVmFsaWRhdG9yPG51bWJlciB8IG51bWJlcltdPlxuICB9LFxuXG4gIGRhdGE6ICgpID0+ICh7XG4gICAgaXRlbXM6IFtdIGFzIFZFeHBhbnNpb25QYW5lbENvbnRlbnRJbnN0YW5jZVtdLFxuICAgIG9wZW46IFtdIGFzIGJvb2xlYW5bXVxuICB9KSxcblxuICBjb21wdXRlZDoge1xuICAgIGNsYXNzZXMgKCk6IG9iamVjdCB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAndi1leHBhbnNpb24tcGFuZWwtLWZvY3VzYWJsZSc6IHRoaXMuZm9jdXNhYmxlLFxuICAgICAgICAndi1leHBhbnNpb24tcGFuZWwtLXBvcG91dCc6IHRoaXMucG9wb3V0LFxuICAgICAgICAndi1leHBhbnNpb24tcGFuZWwtLWluc2V0JzogdGhpcy5pbnNldCxcbiAgICAgICAgLi4udGhpcy50aGVtZUNsYXNzZXNcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgd2F0Y2g6IHtcbiAgICBleHBhbmQgKHY6IGJvb2xlYW4pIHtcbiAgICAgIGxldCBvcGVuSW5kZXggPSAtMVxuICAgICAgaWYgKCF2KSB7XG4gICAgICAgIC8vIENsb3NlIGFsbCBwYW5lbHMgdW5sZXNzIG9ubHkgb25lIGlzIG9wZW5cbiAgICAgICAgY29uc3Qgb3BlbkNvdW50ID0gdGhpcy5vcGVuLnJlZHVjZSgoYWNjLCB2YWwpID0+IHZhbCA/IGFjYyArIDEgOiBhY2MsIDApXG4gICAgICAgIGNvbnN0IG9wZW4gPSBBcnJheSh0aGlzLml0ZW1zLmxlbmd0aCkuZmlsbChmYWxzZSlcblxuICAgICAgICBpZiAob3BlbkNvdW50ID09PSAxKSB7XG4gICAgICAgICAgb3BlbkluZGV4ID0gdGhpcy5vcGVuLmluZGV4T2YodHJ1ZSlcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcGVuSW5kZXggPiAtMSkge1xuICAgICAgICAgIG9wZW5bb3BlbkluZGV4XSA9IHRydWVcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub3BlbiA9IG9wZW5cbiAgICAgIH1cblxuICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB2ID8gdGhpcy5vcGVuIDogKG9wZW5JbmRleCA+IC0xID8gb3BlbkluZGV4IDogbnVsbCkpXG4gICAgfSxcbiAgICB2YWx1ZSAodjogbnVtYmVyIHwgbnVtYmVyW10pIHtcbiAgICAgIHRoaXMudXBkYXRlRnJvbVZhbHVlKHYpXG4gICAgfVxuICB9LFxuXG4gIG1vdW50ZWQgKCkge1xuICAgIHRoaXMudmFsdWUgIT09IG51bGwgJiYgdGhpcy51cGRhdGVGcm9tVmFsdWUodGhpcy52YWx1ZSlcbiAgfSxcblxuICBtZXRob2RzOiB7XG4gICAgdXBkYXRlRnJvbVZhbHVlICh2OiBudW1iZXIgfCBudW1iZXJbXSkge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodikgJiYgIXRoaXMuZXhwYW5kKSByZXR1cm5cblxuICAgICAgbGV0IG9wZW4gPSBBcnJheSh0aGlzLml0ZW1zLmxlbmd0aCkuZmlsbChmYWxzZSlcbiAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgb3Blblt2XSA9IHRydWVcbiAgICAgIH0gZWxzZSBpZiAodiAhPT0gbnVsbCkge1xuICAgICAgICBvcGVuID0gdlxuICAgICAgfVxuXG4gICAgICB0aGlzLnVwZGF0ZVBhbmVscyhvcGVuKVxuICAgIH0sXG4gICAgdXBkYXRlUGFuZWxzIChvcGVuOiBib29sZWFuW10pIHtcbiAgICAgIHRoaXMub3BlbiA9IG9wZW5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBhY3RpdmUgPSBvcGVuICYmIG9wZW5baV1cbiAgICAgICAgdGhpcy5pdGVtc1tpXS50b2dnbGUoYWN0aXZlKVxuICAgICAgfVxuICAgIH0sXG4gICAgcGFuZWxDbGljayAodWlkOiBudW1iZXIpIHtcbiAgICAgIGNvbnN0IG9wZW4gPSB0aGlzLmV4cGFuZCA/IHRoaXMub3Blbi5zbGljZSgpIDogQXJyYXkodGhpcy5pdGVtcy5sZW5ndGgpLmZpbGwoZmFsc2UpXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuaXRlbXNbaV0uX3VpZCA9PT0gdWlkKSB7XG4gICAgICAgICAgb3BlbltpXSA9ICF0aGlzLm9wZW5baV1cbiAgICAgICAgICAhdGhpcy5leHBhbmQgJiYgdGhpcy4kZW1pdCgnaW5wdXQnLCBvcGVuW2ldID8gaSA6IG51bGwpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy51cGRhdGVQYW5lbHMob3BlbilcbiAgICAgIGlmICh0aGlzLmV4cGFuZCkgdGhpcy4kZW1pdCgnaW5wdXQnLCBvcGVuKVxuICAgIH0sXG4gICAgcmVnaXN0ZXIgKGNvbnRlbnQ6IFZFeHBhbnNpb25QYW5lbENvbnRlbnRJbnN0YW5jZSkge1xuICAgICAgdGhpcy5pdGVtcy5wdXNoKGNvbnRlbnQpXG4gICAgICB0aGlzLm9wZW4ucHVzaChmYWxzZSlcbiAgICB9LFxuICAgIHVucmVnaXN0ZXIgKGNvbnRlbnQ6IFZFeHBhbnNpb25QYW5lbENvbnRlbnRJbnN0YW5jZSkge1xuICAgICAgY29uc3QgaW5kZXggPSB0aGlzLml0ZW1zLmZpbmRJbmRleChpID0+IGkuX3VpZCA9PT0gY29udGVudC5fdWlkKVxuICAgICAgdGhpcy5pdGVtcy5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICB0aGlzLm9wZW4uc3BsaWNlKGluZGV4LCAxKVxuICAgIH1cbiAgfSxcblxuICByZW5kZXIgKGgpOiBWTm9kZSB7XG4gICAgcmV0dXJuIGgoJ3VsJywge1xuICAgICAgc3RhdGljQ2xhc3M6ICd2LWV4cGFuc2lvbi1wYW5lbCcsXG4gICAgICBjbGFzczogdGhpcy5jbGFzc2VzXG4gICAgfSwgdGhpcy4kc2xvdHMuZGVmYXVsdClcbiAgfVxufSlcbiJdfQ==